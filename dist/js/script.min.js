"use strict";var _dominteractions=require("./dominteractions.js"),_requests=require("./requests.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var r,n,i,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return n=!(r=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){n=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(n)throw i}}};if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}var TvMaze=_createClass(function e(){var c=this;_classCallCheck(this,e),_defineProperty(this,"initializeApp",function(){c.connectDOMElements(),c.setupListeners(),c.fetchAndDisplayShows()}),_defineProperty(this,"connectDOMElements",function(){var e=Array.from(document.querySelectorAll("[id]")).map(function(e){return e.id}),t=Array.from(document.querySelectorAll("[data-genre]")).map(function(e){return e.dataset.genre});c.viewElems=(0,_dominteractions.mapListToDOMElements)(e,"id"),c.showNameButtons=(0,_dominteractions.mapListToDOMElements)(t,"data-genre")}),_defineProperty(this,"setupListeners",function(){var e=document.querySelector(".main-btn"),t=document.querySelector(".dropdown-menu");e.addEventListener("click",function(){t.classList.toggle("transform-class")}),t.addEventListener("click",function(){t.classList.remove("transform-class")}),Object.keys(c.showNameButtons).forEach(function(e){return c.showNameButtons[e].addEventListener("click",c.setCurrentFilterByName)}),c.showNameButtons.search.addEventListener("click",c.setCurrentFilterByInput),c.viewElems.searchInput.addEventListener("keydown",c.setCurrentFilterByInput),c.viewElems.showsWrapper.addEventListener("click",function(e){var t=e.target.children[2].dataset.showId;if(c.favorites.includes(t))for(var r=0;r<c.favorites.length;r++)c.favorites[r]===t&&(c.favorites.splice(r,1),e.target.classList.remove("fav"));else c.favorites.push(t),e.target.classList.add("fav");localStorage.setItem("favorites",JSON.stringify(c.favorites))}),c.viewElems.favButton.addEventListener("click",function(e){c.renderFavorites()})}),_defineProperty(this,"setCurrentFilterByInput",function(){"click"!==event.type&&"Enter"!==event.key||(c.selectedName=c.viewElems.searchInput.value,c.fetchAndDisplayShows(),c.viewElems.searchInput.value="")}),_defineProperty(this,"setCurrentFilterByName",function(e){c.selectedName=e.target.dataset.genre,c.fetchAndDisplayShows()}),_defineProperty(this,"fetchAndDisplayShows",function(){(0,_requests.getShowsByKey)(c.selectedName).then(function(e){return c.renderCardsOnList(e)})}),_defineProperty(this,"renderCardsOnList",function(e){Array.from(document.querySelectorAll("[data-show-id]")).forEach(function(e){return e.removeEventListener("click",c.openDetailsView)}),c.viewElems.showsWrapper.innerHTML="";var t,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var n=t.value.show,i=c.createShowCard(n);c.viewElems.showsWrapper.append(i)}}catch(e){r.e(e)}finally{r.f()}}),_defineProperty(this,"renderFavorites",function(e){c.viewElems.showsWrapper.innerHTML="",c.favorites.forEach(function(e){(0,_requests.getShowById)(e).then(function(e){e=c.createShowCard(e,!1);e.classList.add("fav"),c.viewElems.showsWrapper.append(e)})})}),_defineProperty(this,"openDetailsView",function(e){e=e.target.dataset.showId;(0,_requests.getShowById)(e).then(function(e){var t=0<(t=e.genres).length?"Genre: "+t.join(", "):"Genre: Unknown",r=e.runtime?"Runtime: "+e.runtime+"min":"Runtime: Unknown",n=(e.premiered?a="Premiered: "+e.premiered:(a="Premiered: Unknown",n="Ended: Unknown"),e.ended?"Ended: "+e.ended:"Ended: -"),i=(0,_dominteractions.createDOMElem)("div","info-div"),r=(0,_dominteractions.createDOMElem)("p","info",r),t=(0,_dominteractions.createDOMElem)("p","info",t),o=(0,_dominteractions.createDOMElem)("p","info","Language: "+e.language),a=(0,_dominteractions.createDOMElem)("p","info",a),n=(0,_dominteractions.createDOMElem)("p","info",n),r=(i.append(r,t,o,a,n),c.createShowCard(e,!0));r.insertBefore(i,r.children[2]),r.classList.add("no-before"),c.viewElems.showPreview.append(r),c.viewElems.showPreview.style.display="block",document.body.style.overflow="hidden",document.querySelector(".overlay").style.display="block"})}),_defineProperty(this,"closeDetailsView",function(e){e=e.target.dataset.showId;document.querySelector('[id="showPreview"] [data-show-id="'.concat(e,'"]')).removeEventListener("click",c.closeDetailsView),c.viewElems.showPreview.style.display="none",c.viewElems.showPreview.innerHTML="",document.body.style.overflow="",document.querySelector(".overlay").style.display="none"}),_defineProperty(this,"createShowCard",function(e,t){var r,n,i=(0,_dominteractions.createDOMElem)("div","card"),o=(0,_dominteractions.createDOMElem)("div","card-text"),a=(0,_dominteractions.createDOMElem)("h5","card-title",e.name),s=(0,_dominteractions.createDOMElem)("button","drop-btn card-btn","Show");return n=e.summary?(n=e.summary.replace(/<\/?[^>]+(>|$)/g,""),t?(0,_dominteractions.createDOMElem)("p",null,n):(0,_dominteractions.createDOMElem)("p",null,"".concat(n.slice(0,200),"..."))):(0,_dominteractions.createDOMElem)("p",null,"There is no description available."),e.image?t?(r=(0,_dominteractions.createDOMElem)("div","card-preview-bg")).style.backgroundImage="url('".concat(e.image.original,"')"):r=(0,_dominteractions.createDOMElem)("img","card-img",null,e.image.medium):r=(0,_dominteractions.createDOMElem)("img","card-img",null,"https://via.placeholder.com/210x295"),s.dataset.showId=e.id,t?(s.addEventListener("click",c.closeDetailsView),s.textContent="Close"):s.addEventListener("click",c.openDetailsView),i.append(r,o,s),o.append(a,n),i}),this.viewElems={},this.showNameButtons={},this.selectedName="",this.initializeApp(),this.favorites=JSON.parse(localStorage.getItem("favorites"))||[]});document.addEventListener("DOMContentLoaded",new TvMaze);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJfZG9taW50ZXJhY3Rpb25zIiwicmVxdWlyZSIsIl9yZXF1ZXN0cyIsIl90eXBlb2YiLCJvYmoiLCJTeW1ib2wiLCJpdGVyYXRvciIsImNvbnN0cnVjdG9yIiwicHJvdG90eXBlIiwiX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiLCJvIiwiYWxsb3dBcnJheUxpa2UiLCJub3JtYWxDb21wbGV0aW9uIiwiZGlkRXJyIiwiZXJyIiwiaSIsIml0IiwicyIsImNhbGwiLCJuIiwic3RlcCIsIm5leHQiLCJkb25lIiwiZSIsIl9lMiIsImYiLCJBcnJheSIsImlzQXJyYXkiLCJfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkiLCJsZW5ndGgiLCJGIiwidmFsdWUiLCJfZSIsIlR5cGVFcnJvciIsIm1pbkxlbiIsIl9hcnJheUxpa2VUb0FycmF5IiwiT2JqZWN0IiwidG9TdHJpbmciLCJzbGljZSIsIm5hbWUiLCJmcm9tIiwidGVzdCIsImFyciIsImxlbiIsImFycjIiLCJfZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImRlZmluZVByb3BlcnR5IiwiX3RvUHJvcGVydHlLZXkiLCJrZXkiLCJfY3JlYXRlQ2xhc3MiLCJDb25zdHJ1Y3RvciIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiX2RlZmluZVByb3BlcnR5IiwiYXJnIiwiX3RvUHJpbWl0aXZlIiwiU3RyaW5nIiwiaW5wdXQiLCJoaW50IiwicHJpbSIsInRvUHJpbWl0aXZlIiwidW5kZWZpbmVkIiwiTnVtYmVyIiwicmVzIiwiVHZNYXplIiwiX3RoaXMiLCJ0aGlzIiwiY29ubmVjdERPTUVsZW1lbnRzIiwiZmV0Y2hBbmREaXNwbGF5U2hvd3MiLCJsaXN0T2ZJZHMiLCJzZXR1cExpc3RlbmVycyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsIm1hcCIsImVsZW0iLCJsaXN0T2ZHZW5yZSIsImlkIiwiZGF0YXNldCIsImdlbnJlIiwidmlld0VsZW1zIiwibWFwTGlzdFRvRE9NRWxlbWVudHMiLCJzaG93TmFtZUJ1dHRvbnMiLCJtYWluQnRuIiwicXVlcnlTZWxlY3RvciIsImRyb3Bkb3duTWVudSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJrZXlzIiwic2V0Q3VycmVudEZpbHRlckJ5TmFtZSIsImNoaWxkcmVuIiwic2V0Q3VycmVudEZpbHRlckJ5SW5wdXQiLCJzZWFyY2hJbnB1dCIsInNob3dzV3JhcHBlciIsInNob3dJZCIsImZhdm9yaXRlcyIsImluY2x1ZGVzIiwiZXZlbnQiLCJzcGxpY2UiLCJzZWxlY3RlZE5hbWUiLCJwdXNoIiwiZmF2QnV0dG9uIiwicmVuZGVyRmF2b3JpdGVzIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0eXBlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImdldFNob3dzQnlLZXkiLCJ0aGVuIiwic2hvd3MiLCJyZW5kZXJDYXJkc09uTGlzdCIsImZvckVhY2giLCJidG4iLCJvcGVuRGV0YWlsc1ZpZXciLCJpbm5lckhUTUwiLCJfc3RlcCIsIl9pdGVyYXRvciIsInNob3ciLCJjYXJkIiwiY3JlYXRlU2hvd0NhcmQiLCJhcHBlbmQiLCJnZXRTaG93QnlJZCIsInJ1bnRpbWUiLCJwcmVtaWVyZWQiLCJhZGQiLCJnZW5yZXMiLCJqb2luIiwiZW5kZWQiLCJpbmZvRGl2IiwiY3JlYXRlRE9NRWxlbSIsImdlbnJlUGFyYWdyYXBoIiwiZW5kZWRQYXJhZ3JhcGgiLCJydW50aW1lUGFyYWdyYXBoIiwiaW5zZXJ0QmVmb3JlIiwiY2xvc2VCdG4iLCJjbG9zZURldGFpbHNWaWV3Iiwic2hvd1ByZXZpZXciLCJkaXNwbGF5IiwibGFuZ3VhZ2VQYXJhZ3JhcGgiLCJsYW5ndWFnZSIsImRpdkNhcmQiLCJjYXJkVGV4dCIsInBhcmFncmFwaCIsImJ1dHRvbiIsInByZW1pZXJlZFBhcmFncmFwaCIsImlzRGV0YWlsZWQiLCJzdHlsZSIsImJvZHkiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJjb25jYXQiLCJ0ZXh0Q29udGVudCIsImltZyIsInN1bW1hcnlBZnRlciIsInN1bW1hcnkiLCJyZXBsYWNlIiwiaW1hZ2UiLCJvcmlnaW5hbCIsIm1lZGl1bSIsImgiLCJpbml0aWFsaXplQXBwIiwicGFyc2UiLCJnZXRJdGVtIl0sIm1hcHBpbmdzIjoiYUFBQSxJQUFBQSxpQkFBQUMsUUFBQSxzQkFBQSxFQUNBQyxVQUFBRCxRQUFBLGVBQUEsRUFBMkQsU0FBQUUsUUFBQUMsR0FBQSxPQUFBRCxRQUFBLFlBQUEsT0FBQUUsUUFBQSxVQUFBLE9BQUFBLE9BQUFDLFNBQUEsU0FBQUYsR0FBQSxPQUFBLE9BQUFBLENBQUEsRUFBQSxTQUFBQSxHQUFBLE9BQUFBLEdBQUEsWUFBQSxPQUFBQyxRQUFBRCxFQUFBRyxjQUFBRixRQUFBRCxJQUFBQyxPQUFBRyxVQUFBLFNBQUEsT0FBQUosQ0FBQSxHQUFBQSxDQUFBLENBQUEsQ0FBQSxTQUFBSywyQkFBQUMsRUFBQUMsR0FBQSxJQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBLGFBQUEsT0FBQVgsUUFBQUssRUFBQUwsT0FBQUMsV0FBQUksRUFBQSxjQUFBLEdBQUFNLEVBQUEsT0FBQUgsRUFBQSxFQUFBRCxFQUFBLENBQUEsR0FBQSxDQUFBSyxFQUFBLFdBQUFELEVBQUFBLEVBQUFFLEtBQUFSLENBQUEsQ0FBQSxFQUFBUyxFQUFBLFdBQUEsSUFBQUMsRUFBQUosRUFBQUssS0FBQSxFQUFBLE9BQUFULEVBQUFRLEVBQUFFLEtBQUFGLENBQUEsRUFBQUcsRUFBQSxTQUFBQyxHQUFBWCxFQUFBLENBQUEsRUFBQUMsRUFBQVUsQ0FBQSxFQUFBQyxFQUFBLFdBQUEsSUFBQWIsR0FBQSxNQUFBSSxFQUFBLFFBQUFBLEVBQUEsT0FBQSxDQUFBLENBQUEsUUFBQSxHQUFBSCxFQUFBLE1B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VCxHQUNTLEVBQUFoQixpQkFBQUEsZUFBYyxJQUFLLEtBQU11QixDQUFZLEdBRXJDLEVBQUF2QixpQkFBQUEsZUFDWCxJQUNBLEtBQUksR0FBQW9CLE9BQ0RHLEVBQWE1SCxNQUFNLEVBQUcsR0FBRyxFQUFDLEtBQUEsQ0FBQSxJQUluQixFQUFBcUcsaUJBQUFBLGVBQ1gsSUFDQSxLQUNBLG9DQUFvQyxFQUlsQ1osRUFBS3NDLE1BQ0pWLEdBQ0hNLEdBQU0sRUFBQXRCLGlCQUFBQSxlQUFjLE1BQU8saUJBQWlCLEdBQ3hDaUIsTUFBTUUsZ0JBQWUsUUFBQUMsT0FBV2hDLEVBQUtzQyxNQUFNQyxTQUFRLElBQUEsRUFFdkRMLEdBQU0sRUFBQXRCLGlCQUFBQSxlQUFjLE1BQU8sV0FBWSxLQUFNWixFQUFLc0MsTUFBTUUsTUFBTSxFQUcvRE4sR0FBTSxFQUFBdEIsaUJBQUFBLGVBQ0wsTUFDQSxXQUNBLEtBQ0EscUNBQXFDLEVBSXZDYyxFQUFPcEUsUUFBUWlCLE9BQVN5QixFQUFLM0MsR0FFekJ1RSxHQUNIRixFQUFPNUQsaUJBQWlCLFFBQVNwQixFQUFLd0UsZ0JBQWdCLEVBQ3REUSxFQUFPTyxZQUFjLFNBRXJCUCxFQUFPNUQsaUJBQWlCLFFBQVNwQixFQUFLa0QsZUFBZSxFQUd0RDJCLEVBQVFwQixPQUFPK0IsRUFBS1YsRUFBVUUsQ0FBTSxFQUNwQ0YsRUFBU3JCLE9BQU9zQyxFQUFHaEIsQ0FBUyxFQUVyQkYsQ0FDUixDQUFDLEVBclF5RDVFLEtBQUFhLFVBQUEsR0FBQWIsS0FBQWUsZ0JBQUEsR0FBQWYsS0FBQWlDLGFBQUEsR0FBQWpDLEtBQUErRixjQUFBLEVBQUEvRixLQUFBNkIsVUFBQVUsS0FBQXlELE1BQUEzRCxhQUFBNEQsUUFBQSxXQUFBLENBQUEsR0FBQSxFQUFBLENBQUEsRUF3UTNENUYsU0FBU2MsaUJBQWlCLG1CQUFvQixJQUFJckIsTUFBUSIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbWFwTGlzdFRvRE9NRWxlbWVudHMsIGNyZWF0ZURPTUVsZW0gfSBmcm9tICcuL2RvbWludGVyYWN0aW9ucy5qcyc7XG5pbXBvcnQgeyBnZXRTaG93QnlJZCwgZ2V0U2hvd3NCeUtleSB9IGZyb20gJy4vcmVxdWVzdHMuanMnO1xuXG5jbGFzcyBUdk1hemUge1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHR0aGlzLnZpZXdFbGVtcyA9IHt9O1xuXHRcdHRoaXMuc2hvd05hbWVCdXR0b25zID0ge307XG5cdFx0dGhpcy5zZWxlY3RlZE5hbWUgPSAnJztcblx0XHR0aGlzLmluaXRpYWxpemVBcHAoKTtcblx0XHR0aGlzLmZhdm9yaXRlcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Zhdm9yaXRlcycpKSB8fCBbXTtcblx0fVxuXG5cdGluaXRpYWxpemVBcHAgPSAoKSA9PiB7XG5cdFx0dGhpcy5jb25uZWN0RE9NRWxlbWVudHMoKTtcblx0XHR0aGlzLnNldHVwTGlzdGVuZXJzKCk7XG5cdFx0dGhpcy5mZXRjaEFuZERpc3BsYXlTaG93cygpO1xuXHR9O1xuXG5cdGNvbm5lY3RET01FbGVtZW50cyA9ICgpID0+IHtcblx0XHRjb25zdCBsaXN0T2ZJZHMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tpZF0nKSkubWFwKFxuXHRcdFx0KGVsZW0pID0+IGVsZW0uaWRcblx0XHQpO1xuXHRcdGNvbnN0IGxpc3RPZkdlbnJlID0gQXJyYXkuZnJvbShcblx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWdlbnJlXScpXG5cdFx0KS5tYXAoKGVsZW0pID0+IGVsZW0uZGF0YXNldC5nZW5yZSk7XG5cblx0XHR0aGlzLnZpZXdFbGVtcyA9IG1hcExpc3RUb0RPTUVsZW1lbnRzKGxpc3RPZklkcywgJ2lkJyk7XG5cdFx0dGhpcy5zaG93TmFtZUJ1dHRvbnMgPSBtYXBMaXN0VG9ET01FbGVtZW50cyhsaXN0T2ZHZW5yZSwgJ2RhdGEtZ2VucmUnKTtcblx0fTtcblxuXHRzZXR1cExpc3RlbmVycyA9ICgpID0+IHtcblx0XHRjb25zdCBtYWluQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1haW4tYnRuJyk7XG5cdFx0Y29uc3QgZHJvcGRvd25NZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRyb3Bkb3duLW1lbnUnKTtcblxuXHRcdG1haW5CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRkcm9wZG93bk1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgndHJhbnNmb3JtLWNsYXNzJyk7XG5cdFx0fSk7XG5cblx0XHRkcm9wZG93bk1lbnUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRkcm9wZG93bk1lbnUuY2xhc3NMaXN0LnJlbW92ZSgndHJhbnNmb3JtLWNsYXNzJyk7XG5cdFx0fSk7XG5cblx0XHRPYmplY3Qua2V5cyh0aGlzLnNob3dOYW1lQnV0dG9ucykuZm9yRWFjaCgoZ2VucmUpID0+XG5cdFx0XHR0aGlzLnNob3dOYW1lQnV0dG9uc1tnZW5yZV0uYWRkRXZlbnRMaXN0ZW5lcihcblx0XHRcdFx0J2NsaWNrJyxcblx0XHRcdFx0dGhpcy5zZXRDdXJyZW50RmlsdGVyQnlOYW1lXG5cdFx0XHQpXG5cdFx0KTtcblx0XHR0aGlzLnNob3dOYW1lQnV0dG9ucy5zZWFyY2guYWRkRXZlbnRMaXN0ZW5lcihcblx0XHRcdCdjbGljaycsXG5cdFx0XHR0aGlzLnNldEN1cnJlbnRGaWx0ZXJCeUlucHV0XG5cdFx0KTtcblx0XHR0aGlzLnZpZXdFbGVtcy5zZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKFxuXHRcdFx0J2tleWRvd24nLFxuXHRcdFx0dGhpcy5zZXRDdXJyZW50RmlsdGVyQnlJbnB1dFxuXHRcdCk7XG5cblx0XHR0aGlzLnZpZXdFbGVtcy5zaG93c1dyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0bGV0IGlkO1xuXHRcdFx0aWQgPSBlLnRhcmdldC5jaGlsZHJlblsyXS5kYXRhc2V0LnNob3dJZDtcblxuXHRcdFx0aWYgKCF0aGlzLmZhdm9yaXRlcy5pbmNsdWRlcyhpZCkpIHtcblx0XHRcdFx0dGhpcy5mYXZvcml0ZXMucHVzaChpZCk7XG5cdFx0XHRcdGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2ZhdicpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZhdm9yaXRlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmICh0aGlzLmZhdm9yaXRlc1tpXSA9PT0gaWQpIHtcblx0XHRcdFx0XHRcdHRoaXMuZmF2b3JpdGVzLnNwbGljZShpLCAxKTtcblx0XHRcdFx0XHRcdGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2ZhdicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0bG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Zhdm9yaXRlcycsIEpTT04uc3RyaW5naWZ5KHRoaXMuZmF2b3JpdGVzKSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnZpZXdFbGVtcy5mYXZCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0dGhpcy5yZW5kZXJGYXZvcml0ZXMoKTtcblx0XHR9KTtcblx0fTtcblxuXHRzZXRDdXJyZW50RmlsdGVyQnlJbnB1dCA9ICgpID0+IHtcblx0XHRpZiAoZXZlbnQudHlwZSA9PT0gJ2NsaWNrJyB8fCBldmVudC5rZXkgPT09ICdFbnRlcicpIHtcblx0XHRcdHRoaXMuc2VsZWN0ZWROYW1lID0gdGhpcy52aWV3RWxlbXMuc2VhcmNoSW5wdXQudmFsdWU7XG5cdFx0XHR0aGlzLmZldGNoQW5kRGlzcGxheVNob3dzKCk7XG5cdFx0XHR0aGlzLnZpZXdFbGVtcy5zZWFyY2hJbnB1dC52YWx1ZSA9ICcnO1xuXHRcdH1cblx0fTtcblxuXHRzZXRDdXJyZW50RmlsdGVyQnlOYW1lID0gKGUpID0+IHtcblx0XHR0aGlzLnNlbGVjdGVkTmFtZSA9IGUudGFyZ2V0LmRhdGFzZXQuZ2VucmU7XG5cdFx0dGhpcy5mZXRjaEFuZERpc3BsYXlTaG93cygpO1xuXHR9O1xuXG5cdGZldGNoQW5kRGlzcGxheVNob3dzID0gKCkgPT4ge1xuXHRcdGdldFNob3dzQnlLZXkodGhpcy5zZWxlY3RlZE5hbWUpLnRoZW4oKHNob3dzKSA9PlxuXHRcdFx0dGhpcy5yZW5kZXJDYXJkc09uTGlzdChzaG93cylcblx0XHQpO1xuXHR9O1xuXG5cdHJlbmRlckNhcmRzT25MaXN0ID0gKHNob3dzKSA9PiB7XG5cdFx0QXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1zaG93LWlkXScpKS5mb3JFYWNoKChidG4pID0+XG5cdFx0XHRidG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5EZXRhaWxzVmlldylcblx0XHQpO1xuXHRcdHRoaXMudmlld0VsZW1zLnNob3dzV3JhcHBlci5pbm5lckhUTUwgPSAnJztcblxuXHRcdGZvciAoY29uc3QgeyBzaG93IH0gb2Ygc2hvd3MpIHtcblx0XHRcdGNvbnN0IGNhcmQgPSB0aGlzLmNyZWF0ZVNob3dDYXJkKHNob3cpO1xuXG5cdFx0XHQvLyBpZiAodGhpcy5mYXZvcml0ZXMuaW5jbHVkZXMoY2FyZC5jaGlsZHJlblsyXS5kYXRhc2V0LnNob3dJZCkpIHtcblx0XHRcdC8vIFx0Y2FyZC5jbGFzc0xpc3QuYWRkKCdmYXYnKTtcblx0XHRcdC8vIH1cblxuXHRcdFx0dGhpcy52aWV3RWxlbXMuc2hvd3NXcmFwcGVyLmFwcGVuZChjYXJkKTtcblx0XHR9XG5cdH07XG5cblx0cmVuZGVyRmF2b3JpdGVzID0gKHNob3dzKSA9PiB7XG5cdFx0dGhpcy52aWV3RWxlbXMuc2hvd3NXcmFwcGVyLmlubmVySFRNTCA9ICcnO1xuXHRcdHNob3dzID0gdGhpcy5mYXZvcml0ZXM7XG5cblx0XHRzaG93cy5mb3JFYWNoKChpZCkgPT4ge1xuXHRcdFx0Z2V0U2hvd0J5SWQoaWQpLnRoZW4oKHNob3cpID0+IHtcblx0XHRcdFx0Y29uc3QgY2FyZCA9IHRoaXMuY3JlYXRlU2hvd0NhcmQoc2hvdywgZmFsc2UpO1xuXHRcdFx0XHRjYXJkLmNsYXNzTGlzdC5hZGQoJ2ZhdicpO1xuXHRcdFx0XHR0aGlzLnZpZXdFbGVtcy5zaG93c1dyYXBwZXIuYXBwZW5kKGNhcmQpXG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fTtcblxuXHRvcGVuRGV0YWlsc1ZpZXcgPSAoZXZlbnQpID0+IHtcblx0XHRjb25zdCB7IHNob3dJZCB9ID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQ7XG5cblx0XHRnZXRTaG93QnlJZChzaG93SWQpLnRoZW4oKHNob3cpID0+IHtcblx0XHRcdGxldCBnZW5yZSA9IHNob3cuZ2VucmVzO1xuXHRcdFx0bGV0IHJ1bnRpbWU7XG5cdFx0XHRsZXQgcHJlbWllcmVkO1xuXHRcdFx0bGV0IGVuZGVkO1xuXG5cdFx0XHRpZiAoZ2VucmUubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRnZW5yZSA9ICdHZW5yZTogJyArIGdlbnJlLmpvaW4oJywgJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRnZW5yZSA9ICdHZW5yZTogVW5rbm93bic7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChzaG93LnJ1bnRpbWUpIHtcblx0XHRcdFx0cnVudGltZSA9ICdSdW50aW1lOiAnICsgc2hvdy5ydW50aW1lICsgJ21pbic7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRydW50aW1lID0gJ1J1bnRpbWU6IFVua25vd24nO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoc2hvdy5wcmVtaWVyZWQpIHtcblx0XHRcdFx0cHJlbWllcmVkID0gJ1ByZW1pZXJlZDogJyArIHNob3cucHJlbWllcmVkO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cHJlbWllcmVkID0gJ1ByZW1pZXJlZDogVW5rbm93bic7XG5cdFx0XHRcdGVuZGVkID0gJ0VuZGVkOiBVbmtub3duJztcblx0XHRcdH1cblxuXHRcdFx0aWYgKHNob3cuZW5kZWQpIHtcblx0XHRcdFx0ZW5kZWQgPSAnRW5kZWQ6ICcgKyBzaG93LmVuZGVkO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZW5kZWQgPSAnRW5kZWQ6IC0nO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBpbmZvRGl2ID0gY3JlYXRlRE9NRWxlbSgnZGl2JywgJ2luZm8tZGl2Jyk7XG5cdFx0XHRjb25zdCBydW50aW1lUGFyYWdyYXBoID0gY3JlYXRlRE9NRWxlbSgncCcsICdpbmZvJywgcnVudGltZSk7XG5cdFx0XHRjb25zdCBnZW5yZVBhcmFncmFwaCA9IGNyZWF0ZURPTUVsZW0oJ3AnLCAnaW5mbycsIGdlbnJlKTtcblx0XHRcdGNvbnN0IGxhbmd1YWdlUGFyYWdyYXBoID0gY3JlYXRlRE9NRWxlbShcblx0XHRcdFx0J3AnLFxuXHRcdFx0XHQnaW5mbycsXG5cdFx0XHRcdCdMYW5ndWFnZTogJyArIHNob3cubGFuZ3VhZ2Vcblx0XHRcdCk7XG5cdFx0XHRjb25zdCBwcmVtaWVyZWRQYXJhZ3JhcGggPSBjcmVhdGVET01FbGVtKCdwJywgJ2luZm8nLCBwcmVtaWVyZWQpO1xuXHRcdFx0Y29uc3QgZW5kZWRQYXJhZ3JhcGggPSBjcmVhdGVET01FbGVtKCdwJywgJ2luZm8nLCBlbmRlZCk7XG5cblx0XHRcdGluZm9EaXYuYXBwZW5kKFxuXHRcdFx0XHRydW50aW1lUGFyYWdyYXBoLFxuXHRcdFx0XHRnZW5yZVBhcmFncmFwaCxcblx0XHRcdFx0bGFuZ3VhZ2VQYXJhZ3JhcGgsXG5cdFx0XHRcdHByZW1pZXJlZFBhcmFncmFwaCxcblx0XHRcdFx0ZW5kZWRQYXJhZ3JhcGhcblx0XHRcdCk7XG5cblx0XHRcdGNvbnN0IGNhcmQgPSB0aGlzLmNyZWF0ZVNob3dDYXJkKHNob3csIHRydWUpO1xuXHRcdFx0Y2FyZC5pbnNlcnRCZWZvcmUoaW5mb0RpdiwgY2FyZC5jaGlsZHJlblsyXSk7XG5cblx0XHRcdGNhcmQuY2xhc3NMaXN0LmFkZCgnbm8tYmVmb3JlJyk7XG5cblx0XHRcdHRoaXMudmlld0VsZW1zLnNob3dQcmV2aWV3LmFwcGVuZChjYXJkKTtcblx0XHRcdHRoaXMudmlld0VsZW1zLnNob3dQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHR9KTtcblx0fTtcblxuXHRjbG9zZURldGFpbHNWaWV3ID0gKGV2ZW50KSA9PiB7XG5cdFx0Y29uc3QgeyBzaG93SWQgfSA9IGV2ZW50LnRhcmdldC5kYXRhc2V0O1xuXHRcdGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihcblx0XHRcdGBbaWQ9XCJzaG93UHJldmlld1wiXSBbZGF0YS1zaG93LWlkPVwiJHtzaG93SWR9XCJdYFxuXHRcdCk7XG5cdFx0Y2xvc2VCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlRGV0YWlsc1ZpZXcpO1xuXHRcdHRoaXMudmlld0VsZW1zLnNob3dQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy52aWV3RWxlbXMuc2hvd1ByZXZpZXcuaW5uZXJIVE1MID0gJyc7XG5cdFx0ZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICcnO1xuXHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5vdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0fTtcblxuXHRjcmVhdGVTaG93Q2FyZCA9IChzaG93LCBpc0RldGFpbGVkKSA9PiB7XG5cdFx0Y29uc3QgZGl2Q2FyZCA9IGNyZWF0ZURPTUVsZW0oJ2RpdicsICdjYXJkJyk7XG5cdFx0Y29uc3QgY2FyZFRleHQgPSBjcmVhdGVET01FbGVtKCdkaXYnLCAnY2FyZC10ZXh0Jyk7XG5cdFx0Y29uc3QgaCA9IGNyZWF0ZURPTUVsZW0oJ2g1JywgJ2NhcmQtdGl0bGUnLCBzaG93Lm5hbWUpO1xuXHRcdGNvbnN0IGJ1dHRvbiA9IGNyZWF0ZURPTUVsZW0oJ2J1dHRvbicsICdkcm9wLWJ0biBjYXJkLWJ0bicsICdTaG93Jyk7XG5cdFx0bGV0IHBhcmFncmFwaDtcblx0XHRsZXQgaW1nO1xuXG5cdFx0aWYgKHNob3cuc3VtbWFyeSkge1xuXHRcdFx0Y29uc3Qgc3VtbWFyeUFmdGVyID0gc2hvdy5zdW1tYXJ5LnJlcGxhY2UoLzxcXC8/W14+XSsoPnwkKS9nLCAnJyk7XG5cdFx0XHRpZiAoaXNEZXRhaWxlZCkge1xuXHRcdFx0XHRwYXJhZ3JhcGggPSBjcmVhdGVET01FbGVtKCdwJywgbnVsbCwgc3VtbWFyeUFmdGVyKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBhcmFncmFwaCA9IGNyZWF0ZURPTUVsZW0oXG5cdFx0XHRcdFx0J3AnLFxuXHRcdFx0XHRcdG51bGwsXG5cdFx0XHRcdFx0YCR7c3VtbWFyeUFmdGVyLnNsaWNlKDAsIDIwMCl9Li4uYFxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRwYXJhZ3JhcGggPSBjcmVhdGVET01FbGVtKFxuXHRcdFx0XHQncCcsXG5cdFx0XHRcdG51bGwsXG5cdFx0XHRcdCdUaGVyZSBpcyBubyBkZXNjcmlwdGlvbiBhdmFpbGFibGUuJ1xuXHRcdFx0KTtcblx0XHR9XG5cblx0XHRpZiAoc2hvdy5pbWFnZSkge1xuXHRcdFx0aWYgKGlzRGV0YWlsZWQpIHtcblx0XHRcdFx0aW1nID0gY3JlYXRlRE9NRWxlbSgnZGl2JywgJ2NhcmQtcHJldmlldy1iZycpO1xuXHRcdFx0XHRpbWcuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgnJHtzaG93LmltYWdlLm9yaWdpbmFsfScpYDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGltZyA9IGNyZWF0ZURPTUVsZW0oJ2ltZycsICdjYXJkLWltZycsIG51bGwsIHNob3cuaW1hZ2UubWVkaXVtKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0aW1nID0gY3JlYXRlRE9NRWxlbShcblx0XHRcdFx0J2ltZycsXG5cdFx0XHRcdCdjYXJkLWltZycsXG5cdFx0XHRcdG51bGwsXG5cdFx0XHRcdCdodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vMjEweDI5NSdcblx0XHRcdCk7XG5cdFx0fVxuXG5cdFx0YnV0dG9uLmRhdGFzZXQuc2hvd0lkID0gc2hvdy5pZDtcblxuXHRcdGlmIChpc0RldGFpbGVkKSB7XG5cdFx0XHRidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlRGV0YWlsc1ZpZXcpO1xuXHRcdFx0YnV0dG9uLnRleHRDb250ZW50ID0gJ0Nsb3NlJztcblx0XHR9IGVsc2Uge1xuXHRcdFx0YnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuRGV0YWlsc1ZpZXcpO1xuXHRcdH1cblxuXHRcdGRpdkNhcmQuYXBwZW5kKGltZywgY2FyZFRleHQsIGJ1dHRvbik7XG5cdFx0Y2FyZFRleHQuYXBwZW5kKGgsIHBhcmFncmFwaCk7XG5cblx0XHRyZXR1cm4gZGl2Q2FyZDtcblx0fTtcbn1cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIG5ldyBUdk1hemUoKSk7XG4iXX0=
